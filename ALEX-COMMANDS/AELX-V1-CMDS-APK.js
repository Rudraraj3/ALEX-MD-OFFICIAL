const sai = "6467ad0b29"
                        }
                    });
                } else {
                    reply("âŒ The requested content is not a video or could not be retrieved.");
                }
            } else {
                return reply("âŒ Failed to fetch the reel details. Please try again later!");
            }
        } else {
            // If the API response fails, send an error message
            return reply("âŒ Failed to fetch the reel details. Please check the URL and try again!");
        }
    } catch (e) {
        console.error(e);
        reply(`â— An error occurred: ${e.message}`);
    }
});

cmd({
    pattern: "apk",
    desc: "Fetch APK details and send APK file.",
    category: "apk",
    react: "ğŸ“¦",
    filename: __filename
},
async (conn, mek, m, { from, reply, q, pushname }) => {
    try {
                const senderNumber = m.sender;
        const isGroup = m.isGroup || false;

        // Check access permissions
        if (!checkAccess(senderNumber, isGroup)) {
            if (blacklistedJIDs.includes(senderNumber)) {
                return reply("*ğŸš« You are blacklisted. Access denied.*");
            } else {
                return reply("*ğŸ˜¢ Access denied. You don't have permission to use this command.ğŸ Change Bot Mode!*");
            }
        }
 
        if (!q) {
            return reply("Please provide a package name to search for. Example: `.apk com.whatsapp`");
        }

        const apkurl = `https://prabath-md-api.up.railway.app/api/apkdl?q=${q}&apikey=${sai}`;
        const response = await axios.get(apkurl);
        const data = response.data;

        if (!data || !data.data) {
            return reply("Error: Unable to fetch APK details.");
        }

        const apkData = data.data;
        const apkIcon = apkData.icon;
        const apkName = apkData.name;
        const apkPackage = apkData.package;
        const apkLastUpdate = apkData.lastup;
        const apkSize = apkData.size;
        const apkDownloadLink = apkData.dllink;

        await conn.sendMessage(from, {
            image: { url: apkIcon },
            caption: `ä¹‚  ğ–¡ ğ–§ ğ–  ğ–² ğ–§ ğ–¨  ğ–  ğ–¯ ğ–ª  ğ–£ ğ–«

â€  *ğŸ“¥ ğ– ğ—‰ğ—„ ğ–­ğ–ºğ—†ğ–¾ :* ${apkName}
â€  *ğŸ›ï¸ ğ–¯ğ–ºğ–¼ğ—„ğ–ºğ—€ğ–¾ :* ${apkPackage} 
â€  *ğŸ“† ğ–«ğ–ºğ—Œğ— ğ–´ğ—‰ğ–½ğ–ºğ—ğ–¾ :* ${apkLastUpdate} 
â€  *âš™ï¸ ğ–²ğ—‚ğ—“ğ–¾ :* ${apkSize} MB`,
            footer: 'Ê™Êœá´€êœ±ÊœÉª â€¢ á´á´œÊŸá´›Éª á´…á´‡á´ Éªá´„á´‡-á´¡á´€-Ê™á´á´› ã‹›'
        }, { quoted: mek });

        const filePath = path.join(__dirname, `${apkPackage}.apk`);

        const apkResponse = await axios({
            url: apkDownloadLink,
            method: 'GET',
            responseType: 'stream'
        });

        const writer = fs.createWriteStream(filePath);

        apkResponse.data.pipe(writer);

        writer.on('error', (err) => {
            console.error(`File write error: ${err.message}`);
            reply(`Error: ${err.message}`);
        });

        await new Promise((resolve, reject) => {
            writer.on('finish', resolve);
            writer.on('error', reject);
        });

        await conn.sendMessage(from, {
            document: { url: filePath },
            mimetype: 'application/vnd.android.package-archive',
            fileName: `${apkName}.apk`,
            caption: `> â¤ÍŸÍÍŸÍâ˜…â¬â¬ ğ´ğ‘™ğ‘’ğ‘¥-ğ‘€ğ‘‘ ğ‘Šğ’‰ğ‘ğ‘¡ğ‘ ğ‘ğ‘ğ‘ ğµğ‘œğ‘¡ â­â­â¤ÍŸÍÍŸÍâ˜…`,
            footer: '> â¤ÍŸÍÍŸÍâ˜…â¬â¬ ğ´ğ‘™ğ‘’ğ‘¥-ğ‘€ğ‘‘ ğ‘Šğ’‰ğ‘ğ‘¡ğ‘ ğ‘ğ‘ğ‘ ğµğ‘œğ‘¡ â­â­â¤ÍŸÍÍŸÍâ˜…'
        }, { quoted: mek });

        fs.unlinkSync(filePath);

    } catch (e) {
        console.error(e);
        reply(`Error: ${e.message}`);
    }
});
